<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Netflix</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{margin:0;background:#000;color:#fff}

/* LOGIN */
#login{
  height:100vh;display:flex;flex-direction:column;
  justify-content:center;align-items:center
}
#login h1{color:#e50914;font-size:42px}
#login input,#login button{
  width:240px;padding:14px;border-radius:4px;border:none
}
#login button{background:#e50914;color:#fff;font-size:16px}

/* PERFIS */
#profiles{display:none;text-align:center;padding-top:60px}
.profiles-grid{
  display:flex;justify-content:center;gap:30px
}
.profile{cursor:pointer}
.avatar{
  width:90px;height:90px;border-radius:12px;
  background:#222;display:flex;align-items:center;
  justify-content:center;font-size:40px
}

/* HOME */
#home{display:none}
header{
  padding:14px;font-size:22px;color:#e50914
}

/* GRID NETFLIX */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;padding:10px
}
.card img{
  width:100%;border-radius:6px;
  aspect-ratio:2/3;object-fit:cover
}

/* PLAYER */
video,iframe{width:100%;border-radius:6px;margin-top:10px}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <h1>Netflix</h1>
  <input type="password" id="password" placeholder="Senha">
  <button onclick="login()">Entrar</button>
</div>

<!-- PERFIS -->
<div id="profiles">
  <h2>Quem estÃ¡ assistindo?</h2>
  <div class="profiles-grid">
    <div class="profile" onclick="selectProfile('real')">
      <div class="avatar">ðŸ˜Ž</div>
      <p>VocÃª</p>
    </div>
    <div class="profile" onclick="selectProfile('fake')">
      <div class="avatar">ðŸŽ¬</div>
      <p>Visitante</p>
    </div>
  </div>
</div>

<!-- HOME -->
<div id="home">
<header>Netflix</header>

<!-- REAL -->
<div id="realMode">
  <h3 style="padding-left:10px">Meus vÃ­deos</h3>
  <input type="file" accept="video/*" multiple onchange="addVideos(event)" style="padding:10px">
  <div class="grid" id="myVideos"></div>
</div>

<!-- FAKE -->
<div id="fakeMode">
  <h3 style="padding-left:10px">Recomendados</h3>
  <div class="grid">
    <div class="card" onclick="playTrailer('https://www.youtube.com/embed/YoHD9XEInc0')">
      <img src="https://image.tmdb.org/t/p/w500/9E2y5Q7WlCVNEhP5GiVTjhEhx1o.jpg">
    </div>
    <div class="card" onclick="playTrailer('https://www.youtube.com/embed/lJ3_biTbeRM')">
      <img src="https://image.tmdb.org/t/p/w500/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg">
    </div>
  </div>
  <iframe id="trailer" height="220" allowfullscreen></iframe>
</div>
</div>

<script>
/* SENHAS */
const REAL_PASSWORD="1234";
const FAKE_PASSWORD="0000";
let mode="";

/* ELEMENTOS */
const loginDiv=login;
const profilesDiv=profiles;
const homeDiv=home;
const realDiv=realMode;
const fakeDiv=fakeMode;
const grid=document.getElementById("myVideos");

/* LOGIN */
function login(){
  const p=password.value;
  if(p===REAL_PASSWORD) mode="real";
  else if(p===FAKE_PASSWORD) mode="fake";
  else return alert("Senha incorreta");

  loginDiv.style.display="none";
  profilesDiv.style.display="block";
}

/* PERFIL */
function selectProfile(p){
  if(p!==mode) return alert("Perfil bloqueado");

  profilesDiv.style.display="none";
  homeDiv.style.display="block";

  if(mode==="real"){
    realDiv.style.display="block";
    fakeDiv.style.display="none";
    loadVideos();
  }else{
    realDiv.style.display="none";
    fakeDiv.style.display="block";
  }
}

/* INDEXED DB */
let db;
indexedDB.open("NetflixDB",1).onupgradeneeded=e=>{
  db=e.target.result;
  db.createObjectStore("videos",{autoIncrement:true});
};
indexedDB.open("NetflixDB",1).onsuccess=e=>db=e.target.result;

function saveVideo(blob){
  const tx=db.transaction("videos","readwrite");
  tx.objectStore("videos").add(blob);
}

function loadVideos(){
  grid.innerHTML="";
  const tx=db.transaction("videos","readonly");
  tx.objectStore("videos").openCursor().onsuccess=e=>{
    const c=e.target.result;
    if(c){
      renderVideo(URL.createObjectURL(c.value));
      c.continue();
    }
  };
}

/* REAL */
function addVideos(e){
  if(mode!=="real") return;
  [...e.target.files].forEach(f=>{
    saveVideo(f);
    renderVideo(URL.createObjectURL(f));
  });
}

function renderVideo(url){
  const v=document.createElement("video");
  v.src=url;v.controls=true;
  grid.appendChild(v);
}

/* FAKE */
function playTrailer(url){
  if(mode==="fake") trailer.src=url;
}
</script>

</body>
</html>
